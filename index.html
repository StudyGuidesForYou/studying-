<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Aurora ‚Äî Web OS</title>

<!-- Tailwind CSS -->
<script src="https://cdn.tailwindcss.com"></script>

<!-- Interact.js for drag/resize -->
<script src="https://cdn.jsdelivr.net/npm/interactjs/dist/interact.min.js"></script>

<!-- xterm.js -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/xterm/css/xterm.css" />
<script src="https://cdn.jsdelivr.net/npm/xterm/lib/xterm.js"></script>

<style>
:root{
  --bg1: linear-gradient(135deg,#0f172a 0%, #021025 60%, #052b36 100%);
  --glass: rgba(255,255,255,0.06);
  --glass-2: rgba(255,255,255,0.04);
  --accent: #7c5cff;
  --accent-2: #00e5ff;
  --radius: 14px;
}
html,body,#root{height:100%;}
body{
  margin:0;
  font-family:Inter,ui-sans-serif,system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial;
  -webkit-font-smoothing:antialiased;
  -moz-osx-font-smoothing:grayscale;
  background:var(--bg1);
  overflow:hidden;
}
#wallpaper{position:fixed; inset:0; background-position:center; background-size:cover; filter:blur(0.3px) saturate(1.05);}
#desktop{position:absolute; inset:0; padding:24px; display:flex; flex-wrap:wrap; gap:18px; align-content:flex-start;}
.desk-icon{width:84px;text-align:center;color:white;cursor:pointer;user-select:none}
.desk-icon img{width:64px;height:64px;border-radius:16px;box-shadow:0 4px 20px rgba(2,6,23,0.6);}
.desk-icon span{display:block;margin-top:6px;font-size:13px;max-width:84px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}

/* Taskbar */
#taskbar{
  position:fixed;left:0;right:0;bottom:0;height:56px;padding:6px 18px;display:flex;align-items:center;gap:12px;
  background:linear-gradient(180deg, rgba(8,10,15,0.18), rgba(8,10,15,0.28));backdrop-filter: blur(8px);
  border-top: 1px solid rgba(255,255,255,0.03);
}
#start-button{
  width:44px;height:44px;border-radius:12px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
  display:flex;align-items:center;justify-content:center;color:white;font-weight:600;cursor:pointer;
  box-shadow:0 6px 22px rgba(2,6,23,0.6);
}
#taskbar .pinned {display:flex;gap:8px;align-items:center}
.tb-btn{height:40px;min-width:40px;padding:6px;border-radius:10px;background:transparent;border:none;cursor:pointer;color:white;display:flex;align-items:center;justify-content:center}
.tb-btn:hover{background:rgba(255,255,255,0.03)}

/* Window style */
.aurora-window{position:absolute;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border-radius:14px;box-shadow:0 20px 50px rgba(2,6,23,0.7);overflow:hidden;border:1px solid rgba(255,255,255,0.03)}
.win-title{display:flex;align-items:center;justify-content:space-between;padding:8px 10px;background:linear-gradient(180deg, rgba(255,255,255,0.02), transparent);backdrop-filter: blur(3px);cursor:move}
.win-title .left{display:flex;gap:8px;align-items:center;font-weight:600}
.win-controls button{margin-left:6px;border-radius:8px;width:32px;height:28px;background:transparent;border:0;color:white;cursor:pointer;font-size:16px}
.win-body{height:calc(100% - 44px);background:transparent;overflow:auto;padding:8px}

/* Start Menu */
#start-menu{position:fixed;left:50%;transform:translateX(-50%);bottom:72px;background:linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.02));border-radius:16px;padding:14px;width:760px;box-shadow:0 30px 70px rgba(2,6,23,0.7);display:flex;gap:14px;color:white}
.start-left{width:46%}
.start-right{width:54%;display:flex;flex-direction:column;gap:8px}
.app-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:10px}
.app-card{display:flex;align-items:center;gap:10px;padding:8px;border-radius:10px;cursor:pointer}
.app-card:hover{background:rgba(255,255,255,0.02)}

/* Context menu */
.ctx{position:fixed;background:#0b1220;color:white;border-radius:8px;padding:8px;box-shadow:0 10px 30px rgba(2,6,23,0.6);display:none;z-index:9999}
.ctx button{display:block;width:100%;text-align:left;padding:6px;border-radius:6px;background:transparent;border:0;color:white;cursor:pointer}

/* helpers */
.muted{color:rgba(255,255,255,0.6);font-size:13px}
.icon-small{width:22px;height:22px;border-radius:6px}
textarea,input{background:rgba(255,255,255,0.05);color:white;border:none;border-radius:8px;padding:6px;font-family:inherit;}
button{cursor:pointer;}
</style>
</head>
<body>

<div id="wallpaper" style="background-image: radial-gradient(circle at 10% 20%, rgba(124,92,255,0.18), transparent 10%), radial-gradient(circle at 80% 80%, rgba(0,229,255,0.06), transparent 10%), linear-gradient(135deg,#021025 0%, #052b36 100%);"></div>
<div id="desktop" oncontextmenu="return false;"></div>

<div id="start-menu" style="display:none" aria-hidden="true">
  <div class="start-left">
    <div style="display:flex;align-items:center;gap:12px;margin-bottom:10px">
      <div style="width:48px;height:48px;border-radius:12px;background:linear-gradient(135deg,var(--accent),var(--accent-2));display:flex;align-items:center;justify-content:center;font-weight:700">A</div>
      <div>
        <div style="font-weight:700;font-size:16px">Aurora</div>
        <div class="muted">Welcome back ‚Äî ready to explore?</div>
      </div>
    </div>
    <div style="margin-top:8px" class="muted">Pinned</div>
    <div id="pinned-grid" class="app-grid" style="margin-top:8px"></div>
  </div>
  <div class="start-right">
    <div style="display:flex;justify-content:space-between;align-items:center">
      <div style="font-weight:700">All apps</div>
      <input id="start-search" placeholder="Search apps..." />
    </div>
    <div id="all-apps" style="overflow:auto;height:420px;margin-top:8px"></div>
  </div>
</div>

<div id="taskbar">
  <div id="start-button" title="Start (press Win or click)">
    <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
      <path d="M3 3h4v4H3V3zM9 3h6v4H9V3zM15 3h6v4h-6V3zM3 9h4v6H3V9zM9 9h6v6H9V9zM15 9h6v6h-6V9zM3 15h4v6H3v-6zM9 15h6v6H9v-6zM15 15h6v6h-6v-6z" fill="white"/>
    </svg>
  </div>
  <div class="pinned" id="taskbar-pinned"></div>
  <div style="flex:1"></div>
  <div style="display:flex;gap:10px;align-items:center;color:white">
    <div id="tray-wifi" class="muted">Aurora</div>
    <div id="tray-time" class="muted"></div>
    <div id="tray-open-menu" style="width:40px;height:40px;border-radius:8px;background:transparent;display:flex;align-items:center;justify-content:center;cursor:pointer">‚öôÔ∏è</div>
  </div>
</div>

<div id="ctx-menu" class="ctx" role="menu">
  <button onclick="createNewFile()">New text file</button>
  <button onclick="refreshDesktop()">Refresh</button>
  <button onclick="openSettings()">Change wallpaper</button>
</div>

<div id="windows-root"></div>

<script>
/* ---------- Apps ---------- */
// Native Aurora Apps
const APPS=[
  {id:'aura-notepad',name:'Aurora Notes',icon:'üìù',type:'app',run:notepadApp},
  {id:'aura-calc',name:'Aurora Calc',icon:'üßÆ',type:'app',run:calculatorApp},
  {id:'aura-paint',name:'Aurora Paint',icon:'üé®',type:'app',run:paintApp},
  {id:'aura-terminal',name:'Aurora Terminal',icon:'üíª',type:'app',run:terminalApp},
  {id:'aura-files',name:'Aurora Files',icon:'üìÅ',type:'app',run:filesApp},
  {id:'aura-settings',name:'Aurora Settings',icon:'‚öôÔ∏è',type:'app',run:settingsApp},
  {id:'aura-photos',name:'Aurora Photos',icon:'üñºÔ∏è',type:'app',run:photosApp},
  {id:'aura-music',name:'Aurora Music',icon:'üéµ',type:'app',run:musicApp},
  {id:'aura-browser',name:'Aurora Browser',icon:'üåê',type:'app',run:browserApp},

  // Web apps (all restored)
  {id:'DayDreamX', name:'DayDreamX', icon:'üí≠', type:'web', url:'https://study.info.north-kazakhstan.su.cdn.cloudflare.net/'},
  {id:'Velera', name:'Velera', icon:'üöÄ', type:'web', url:'https://zearn.buzz.cdn.cloudflare.net/'},
  {id:'Truffled', name:'Truffled', icon:'üçÑ', type:'web', url:'https://truffled.example/'},
  {id:'PeteZah', name:'PeteZah', icon:'üêæ', type:'web', url:'https://pete.example/'},
  {id:'UniUBv4', name:'UniUB v4', icon:'üéì', type:'web', url:'https://university.example/'},
  {id:'Rosin', name:'Rosin', icon:'ü™µ', type:'web', url:'https://lbbjwojcgm.antrak.org.tr/'},
  {id:'Nexus', name:'Nexus', icon:'üï∏Ô∏è', type:'web', url:'https://nexus-is.onthewifi.com/'},
  {id:'DogeUB', name:'DogeUB', icon:'üê∂', type:'web', url:'https://math.linked8.net/indev'},
  {id:'RammerHead', name:'RammerHead', icon:'üéß', type:'web', url:'https://geo.searchgpy.com/'},
  {id:'CBmagic', name:'CBmagic', icon:'‚ú®', type:'web', url:'https://soloo.fun/'},
  {id:'Axiom', name:'Axiom', icon:'üß©', type:'web', url:'https://ultralight.mwbread.com/'},
  {id:'Quasar', name:'Quasar', icon:'üåå', type:'web', url:'https://tuition.oneuniversity.info/'},
  {id:'Boredom', name:'Boredom', icon:'üòê', type:'web', url:'https://boredom.global.ssl.fastly.net/?_sm_au_=iHVW0PqgfVNrr60Q7K3CjK60HMLcq'},
  {id:'SomeStuff', name:'SomeStuff', icon:'üì¶', type:'web', url:'https://wmath.pages.dev/#prxy'},
  {id:'Galaxy', name:'Galaxy', icon:'üå†', type:'web', url:'https://frylight.jumpingcrab.com/'},
  {id:'Eldardo', name:'Eldardo', icon:'üõ∏', type:'web', url:'https://eldardo.net/app/'}
];

/* ---------- State ---------- */
const state={windows:[],z:100,pinned:JSON.parse(localStorage.getItem('aurora_pinned')||'[]'),wallpaper:localStorage.getItem('aurora_wallpaper')||'',dark:true,files:JSON.parse(localStorage.getItem('aurora_files')||'[]')};

const desktop=document.getElementById('desktop');
const windowsRoot=document.getElementById('windows-root');
const startMenu=document.getElementById('start-menu');
const pinnedGrid=document.getElementById('pinned-grid');
const allAppsEl=document.getElementById('all-apps');
const taskbarPinned=document.getElementById('taskbar-pinned');
const trayTime=document.getElementById('tray-time');
const ctxMenu=document.getElementById('ctx-menu');
const wallpaperEl=document.getElementById('wallpaper');
const startSearch=document.getElementById('start-search');

/* ---------- Utility ---------- */
function findApp(id){return APPS.find(a=>a.id===id||a.name===id);}
function selectIcon(el){document.querySelectorAll('.desk-icon').forEach(d=>d.style.outline='none'); el.style.outline='2px solid rgba(255,255,255,0.06)'; setTimeout(()=>el.style.outline='none',1200);}

/* ---------- Desktop & Start Menu ---------- */
function renderDesktop(){
  desktop.innerHTML='';
  APPS.forEach(app=>{
    const el=document.createElement('div'); el.className='desk-icon'; el.title=app.name;
    el.innerHTML=`<div style="font-size:40px">${app.icon}</div><span>${app.name}</span>`;
    el.ondblclick=()=>openAppWindow(app); el.onclick=()=>selectIcon(el);
    desktop.appendChild(el);
  });
}

function renderStartMenu(){
  pinnedGrid.innerHTML=''; state.pinned.forEach(id=>{
    const app=findApp(id); if(!app) return;
    const card=document.createElement('div'); card.className='app-card'; card.innerHTML=`<span style="font-size:24px">${app.icon}</span> ${app.name}`;
    card.onclick=()=>openAppWindow(app); pinnedGrid.appendChild(card);
  });
  allAppsEl.innerHTML=''; APPS.forEach(app=>{
    const row=document.createElement('div'); row.className='app-card'; row.innerHTML=`<span style="font-size:24px">${app.icon}</span> ${app.name}`;
    row.onclick=()=>openAppWindow(app); allAppsEl.appendChild(row);
  });
}

/* ---------- Window Management ---------- */
function focusWindow(id){const el=document.getElementById(id); if(el) el.style.zIndex=++state.z;}

function openAppWindow(app){
  if(!app) return; 
  const id='win-'+app.id;
  let existing=document.getElementById(id); 
  if(existing){existing.style.display='block'; focusWindow(id); return;}

  const win=document.createElement('div'); win.id=id; win.className='aurora-window';

  // Dynamic size based on screen
  const width = Math.min(window.innerWidth * 0.75, 1000);
  const height = Math.min(window.innerHeight * 0.75, 700);
  win.style.width = width + 'px';
  win.style.height = height + 'px';
  win.style.left = (window.innerWidth - width)/2 + 'px';
  win.style.top = (window.innerHeight - height)/2 + 'px';
  win.style.zIndex=++state.z;

  if(app.type==='web'){
    win.innerHTML=`<div class="win-title"><div class="left">${app.name}</div>
      <div class="win-controls">
        <button onclick="minimizeWindow('${id}')">_</button>
        <button onclick="toggleMaximize('${id}')">‚ñ°</button>
        <button onclick="closeWindow('${id}')">√ó</button>
      </div></div>
      <div class="win-body"><iframe src="${app.url}" style="width:100%;height:100%;border:0" loading="lazy"></iframe></div>`;
  } else if(app.type==='app'){
    win.innerHTML=`<div class="win-title"><div class="left">${app.name}</div>
      <div class="win-controls">
        <button onclick="minimizeWindow('${id}')">_</button>
        <button onclick="toggleMaximize('${id}')">‚ñ°</button>
        <button onclick="closeWindow('${id}')">√ó</button>
      </div></div>
      <div class="win-body" id="app-body-${id}"></div>`;
    try{app.run('app-body-'+id);} catch(e){console.error(e);}
  }

  windowsRoot.appendChild(win);

  // Drag & Resize
  interact(win).draggable({allowFrom:'.win-title', modifiers:[interact.modifiers.restrictRect({restriction:'parent'})], listeners:{move(event){const {x,y}=event.target.dataset; const dx=event.dx; const dy=event.dy; let nx=(x?parseFloat(x):0)+dx; let ny=(y?parseFloat(y):0)+dy; event.target.style.transform=`translate(${nx}px,${ny}px)`; event.target.dataset.x=nx; event.target.dataset.y=ny;}}})
    .resizable({edges:{left:true,right:true,bottom:true,top:true},listeners:{move(event){let {width,height}=event.rect; event.target.style.width=width+'px'; event.target.style.height=height+'px';}}});
}

function minimizeWindow(id){const el=document.getElementById(id); if(el) el.style.display='none';}
function closeWindow(id){const el=document.getElementById(id); if(el) el.remove();}
function toggleMaximize(id){
  const el=document.getElementById(id);
  if(!el) return;
  if(el.dataset.max==='1'){el.style.width='75%'; el.style.height='75%'; el.style.left='12.5%'; el.style.top='12.5%'; el.dataset.max='0';}
  else{el.style.width='100%'; el.style.height='100%'; el.style.left='0'; el.style.top='0'; el.dataset.max='1';}
}

/* ---------- Clock ---------- */
function updateClock(){const d=new Date(); trayTime.textContent=d.toLocaleTimeString([], {hour:'2-digit',minute:'2-digit'});}
setInterval(updateClock,1000); updateClock();

/* ---------- Context Menu ---------- */
desktop.oncontextmenu=e=>{
  e.preventDefault();
  ctxMenu.style.left=e.clientX+'px';
  ctxMenu.style.top=e.clientY+'px';
  ctxMenu.style.display='block';
};
desktop.onclick=()=>ctxMenu.style.display='none';

/* ---------- Wallpaper ---------- */
if(state.wallpaper) wallpaperEl.style.backgroundImage=`url(${state.wallpaper})`;

/* ---------- Start Button ---------- */
document.getElementById('start-button').onclick=()=>{
  startMenu.style.display=startMenu.style.display==='none'?'flex':'none';
  renderStartMenu();
};

/* ---------- Search ---------- */
startSearch.oninput=()=>{const q=startSearch.value.toLowerCase(); allAppsEl.childNodes.forEach(row=>{
  row.style.display=row.textContent.toLowerCase().includes(q)?'flex':'none';
})};

/* ---------- Desktop Render ---------- */
renderDesktop();

/* ---------- Placeholder App Functions ---------- */
function notepadApp(id){const c=document.getElementById(id); if(!c) return; c.innerHTML='<textarea style="width:100%;height:100%;"></textarea>';}
function calculatorApp(id){const c=document.getElementById(id); if(!c) return; c.innerHTML='<div>Calculator Placeholder</div>';}
function paintApp(id){const c=document.getElementById(id); if(!c) return; c.innerHTML='<div>Paint Placeholder</div>';}
function terminalApp(id){const c=document.getElementById(id); if(!c) return; c.innerHTML='<div>Terminal Placeholder</div>';}
function filesApp(id){const c=document.getElementById(id); if(!c) return; c.innerHTML='<div>Files Placeholder</div>';}
function settingsApp(id){const c=document.getElementById(id); if(!c) return; c.innerHTML='<div>Settings Placeholder</div>';}
function photosApp(id){const c=document.getElementById(id); if(!c) return; c.innerHTML='<div>Photos Placeholder</div>';}
function musicApp(id){const c=document.getElementById(id); if(!c) return; c.innerHTML='<div>Music Placeholder</div>';}
function browserApp(id){const c=document.getElementById(id); if(!c) return; c.innerHTML='<div>Browser Placeholder</div>';}
function createNewFile(){alert('Create new file (placeholder)');}
function refreshDesktop(){renderDesktop();}
function openSettings(){alert('Change wallpaper placeholder');}
</script>
</body>
</html>
